try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="bac3030e-3b33-45b9-9aea-9844901de0f7",e._sentryDebugIdIdentifier="sentry-dbid-bac3030e-3b33-45b9-9aea-9844901de0f7")}catch(e){}"use strict";exports.id=4985,exports.ids=[4985],exports.modules={14985:(e,t,r)=>{r.d(t,{F0:()=>eA,lu:()=>eI,qy:()=>eT,wn:()=>eD});var n,a,o,s,i,l,u,c,d,p,f=r(37581),m=r(26779),h=r(42634),y=r(48978),v=r(63236),g=Object.defineProperty,z=(e,t)=>{for(var r in t)g(e,r,{get:t[r],enumerable:!0})};async function b(e){return void 0===e?Promise.resolve():new Promise(t=>setTimeout(t,e))}var x="AI_RetryError",w=`vercel.ai.error.${x}`,T=Symbol.for(w),S=class extends f.AX{constructor({message:e,reason:t,errors:r}){super({name:x,message:e}),this[n]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return f.AX.hasMarker(e,w)}static isRetryError(e){return e instanceof Error&&e.name===x&&"string"==typeof e.reason&&Array.isArray(e.errors)}toJSON(){return{name:this.name,message:this.message,reason:this.reason,lastError:this.lastError,errors:this.errors}}};n=T;var A={spanContext:()=>I,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},I={traceId:"",spanId:"",traceFlags:0},E="AI_DownloadError",_=`vercel.ai.error.${E}`,R=Symbol.for(_),k=class extends f.AX{constructor({url:e,statusCode:t,statusText:r,cause:n,message:o=null==n?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:E,message:o,cause:n}),this[a]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return f.AX.hasMarker(e,_)}static isDownloadError(e){return e instanceof Error&&e.name===E&&"string"==typeof e.url&&(null==e.statusCode||"number"==typeof e.statusCode)&&(null==e.statusText||"string"==typeof e.statusText)}toJSON(){return{name:this.name,message:this.message,url:this.url,statusCode:this.statusCode,statusText:this.statusText,cause:this.cause}}};a=R;var $="AI_InvalidDataContentError",j=`vercel.ai.error.${$}`,D=Symbol.for(j),C=class extends f.AX{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:$,message:r,cause:t}),this[o]=!0,this.content=e}static isInstance(e){return f.AX.hasMarker(e,j)}static isInvalidDataContentError(e){return e instanceof Error&&e.name===$&&null!=e.content}toJSON(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause,content:this.content}}};o=D;var M=h.z.union([h.z.string(),h.z.instanceof(Uint8Array),h.z.instanceof(ArrayBuffer),h.z.custom(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]),N="AI_InvalidMessageRoleError",X=`vercel.ai.error.${N}`,q=Symbol.for(X);f.AX,s=q;var F="AI_InvalidArgumentError",O=`vercel.ai.error.${F}`,J=Symbol.for(O);f.AX,i=J;var B=h.z.lazy(()=>h.z.union([h.z.null(),h.z.string(),h.z.number(),h.z.boolean(),h.z.record(h.z.string(),B),h.z.array(B)])),P=h.z.record(h.z.string(),h.z.record(h.z.string(),B)),L=h.z.array(h.z.union([h.z.object({type:h.z.literal("text"),text:h.z.string()}),h.z.object({type:h.z.literal("image"),data:h.z.string(),mimeType:h.z.string().optional()})])),U=h.z.object({type:h.z.literal("text"),text:h.z.string(),experimental_providerMetadata:P.optional()}),V=h.z.object({type:h.z.literal("image"),image:h.z.union([M,h.z.instanceof(URL)]),mimeType:h.z.string().optional(),experimental_providerMetadata:P.optional()}),G=h.z.object({type:h.z.literal("file"),data:h.z.union([M,h.z.instanceof(URL)]),mimeType:h.z.string(),experimental_providerMetadata:P.optional()}),H=h.z.object({type:h.z.literal("tool-call"),toolCallId:h.z.string(),toolName:h.z.string(),args:h.z.unknown()}),W=h.z.object({type:h.z.literal("tool-result"),toolCallId:h.z.string(),toolName:h.z.string(),result:h.z.unknown(),content:L.optional(),isError:h.z.boolean().optional(),experimental_providerMetadata:P.optional()}),K=h.z.object({role:h.z.literal("system"),content:h.z.string(),experimental_providerMetadata:P.optional()}),Q=h.z.object({role:h.z.literal("user"),content:h.z.union([h.z.string(),h.z.array(h.z.union([U,V,G]))]),experimental_providerMetadata:P.optional()}),Y=h.z.object({role:h.z.literal("assistant"),content:h.z.union([h.z.string(),h.z.array(h.z.union([U,H]))]),experimental_providerMetadata:P.optional()}),Z=h.z.object({role:h.z.literal("tool"),content:h.z.array(W),experimental_providerMetadata:P.optional()});h.z.union([K,Q,Y,Z]);var ee="AI_MessageConversionError",et=`vercel.ai.error.${ee}`,er=Symbol.for(et);function en(e,{contentType:t,dataStreamVersion:r}){var n;let a=new Headers(null!=(n=null==e?void 0:e.headers)?n:{});return a.has("Content-Type")||a.set("Content-Type",t),void 0!==r&&a.set("X-Vercel-AI-Data-Stream",r),a}f.AX,l=er;var ea="AI_NoObjectGeneratedError",eo=`vercel.ai.error.${ea}`,es=Symbol.for(eo),ei=class extends f.AX{constructor({message:e="No object generated."}={}){super({name:ea,message:e}),this[u]=!0}static isInstance(e){return f.AX.hasMarker(e,eo)}static isNoObjectGeneratedError(e){return e instanceof Error&&e.name===ea}toJSON(){return{name:this.name,cause:this.cause,message:this.message,stack:this.stack}}};u=es;(0,m.bF)({prefix:"aiobj",size:24});(0,m.bF)({prefix:"aiobj",size:24});var el="AI_InvalidToolArgumentsError",eu=`vercel.ai.error.${el}`,ec=Symbol.for(eu);f.AX,c=ec;var ed="AI_NoSuchToolError",ep=`vercel.ai.error.${ed}`,ef=Symbol.for(ep);f.AX,d=ef;function em(e,t){let r,n;let a=e.getReader(),o=t.getReader(),s=!1,i=!1;async function l(e){try{null==r&&(r=a.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==n&&(n=o.read());let t=await n;n=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(s){await u(e);return}if(i){await l(e);return}null==r&&(r=a.read()),null==n&&(n=o.read());let{result:t,reader:c}=await Promise.race([r.then(e=>({result:e,reader:a})),n.then(e=>({result:e,reader:o}))]);t.done||e.enqueue(t.value),c===a?(r=void 0,t.done&&(await u(e),s=!0)):(n=void 0,t.done&&(i=!0,await l(e)))}catch(t){e.error(t)}},cancel(){a.cancel(),o.cancel()}})}(0,m.bF)({prefix:"aitxt",size:24}),(0,m.bF)({prefix:"aitxt",size:24});var eh="AI_NoSuchProviderError",ey=`vercel.ai.error.${eh}`,ev=Symbol.for(ey);function eg(e){let t=new TextEncoder,r="",n=e||{};return new TransformStream({async start(){n.onStart&&await n.onStart()},async transform(e,a){let o="string"==typeof e?e:e.content;a.enqueue(t.encode(o)),r+=o,n.onToken&&await n.onToken(o),n.onText&&"string"==typeof e&&await n.onText(e)},async flush(){n.onCompletion&&await n.onCompletion(r),!n.onFinal||"experimental_onFunctionCall"in n||await n.onFinal(r)}})}function ez(){let e=!0;return t=>(e&&(t=t.trimStart())&&(e=!1),t)}function eb(e){let t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(e){let{done:r,value:n}=await t.next();r?e.close():e.enqueue(n)},async cancel(e){var r;await (null==(r=t.return)?void 0:r.call(t,e))}})}function ex(){let e=new TextEncoder,t=new TextDecoder;return new TransformStream({transform:async(r,n)=>{let a=t.decode(r);n.enqueue(e.encode((0,v.vl)("text",a)))}})}async function*ew(e){for await(let t of e)if("completion"in t){let e=t.completion;e&&(yield e)}else if("delta"in t){let{delta:e}=t;if("text"in e){let t=e.text;t&&(yield t)}}}function eT(e,t){if(Symbol.asyncIterator in e)return eb(ew(e)).pipeThrough(eg(t)).pipeThrough(ex());{let r;return(function(e,t,r){if(!e.ok){if(!e.body)return new ReadableStream({start(e){e.error(Error("Response error: No response body"))}});{let t=e.body.getReader();return new ReadableStream({async start(e){let{done:r,value:n}=await t.read();if(!r){let t=new TextDecoder().decode(n);e.error(Error(`Response error: ${t}`))}}})}}return(e.body||new ReadableStream({start(e){e.close()}})).pipeThrough(function(e){let t;let r=new TextDecoder;return new TransformStream({async start(r){t=(0,y.j)(t=>{if("data"in t&&"event"===t.type&&"[DONE]"===t.data||"done"===t.event){r.terminate();return}if("data"in t){let n=e?e(t.data,{event:t.event}):t.data;n&&r.enqueue(n)}})},transform(e){t.feed(r.decode(e))}})}(t)).pipeThrough(eg(r))})(e,(r="",e=>{let t=JSON.parse(e);if("error"in t)throw Error(`${t.error.type}: ${t.error.message}`);if(!("completion"in t))return;let n=t.completion;if(!r||n.length>r.length&&n.startsWith(r)){let e=n.slice(r.length);return r=n,e}return n}),t).pipeThrough(ex())}}f.JJ,p=ev;new TextDecoder("utf-8");async function*eS(e){var t,r,n;for await(let a of e.stream){let e=null==(n=null==(r=null==(t=a.candidates)?void 0:t[0])?void 0:r.content)?void 0:n.parts;if(void 0===e)continue;let o=e[0];"string"==typeof o.text&&(yield o.text)}}function eA(e,t){return eb(eS(e)).pipeThrough(eg(t)).pipeThrough(ex())}function eI(e,t){return(function(e){let t=ez();return new ReadableStream({async pull(r){var n,a;let{value:o,done:s}=await e.next();if(s){r.close();return}let i=t(null!=(a=null==(n=o.token)?void 0:n.text)?a:"");if(i){if(null!=o.generated_text&&o.generated_text.length>0||"</s>"===i||"<|endoftext|>"===i||"<|end|>"===i)return;r.enqueue(i)}}})})(e).pipeThrough(eg(t)).pipeThrough(ex())}function eE(e,t){return e_(e,t)}function e_(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;if("string"==typeof e){t.enqueue(e);return}if("event"in e){"on_chat_model_stream"===e.event&&ek(null==(r=e.data)?void 0:r.chunk,t);return}ek(e,t)}})).pipeThrough(eg(t)).pipeThrough(ex())}function eR(e,t){var r;let n=e_(e,null==t?void 0:t.callbacks),a=null==t?void 0:t.data,o=null==t?void 0:t.init;return new Response(a?em(a.stream,n):n,{status:null!=(r=null==o?void 0:o.status)?r:200,statusText:null==o?void 0:o.statusText,headers:en(o,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function ek(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let r of e.content)"text"===r.type&&t.enqueue(r.text)}function e$(e,t){return(function(e){let t=e[Symbol.asyncIterator](),r=ez();return new ReadableStream({async pull(e){var n;let{value:a,done:o}=await t.next();if(o){e.close();return}let s=r(null!=(n=a.delta)?n:"");s&&e.enqueue(s)}})})(e).pipeThrough(eg(t)).pipeThrough(ex())}function ej(e,t={}){var r;let{init:n,data:a,callbacks:o}=t,s=e$(e,o);return new Response(a?em(a.stream,s):s,{status:null!=(r=null==n?void 0:n.status)?r:200,statusText:null==n?void 0:n.statusText,headers:en(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}z({},{toAIStream:()=>eE,toDataStream:()=>e_,toDataStreamResponse:()=>eR}),z({},{toDataStream:()=>e$,toDataStreamResponse:()=>ej});Symbol("internal_openai_fn_messages");var eD=class extends Response{constructor(e,t,r){let n=e;r&&(n=em(r.stream,e)),super(n,{...t,status:200,headers:en(t,{contentType:"text/plain; charset=utf-8"})})}}}};
//# sourceMappingURL=4985.js.map