try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d5fb31e9-1494-4deb-972b-e5b33a6f0c16",e._sentryDebugIdIdentifier="sentry-dbid-d5fb31e9-1494-4deb-972b-e5b33a6f0c16")}catch(e){}"use strict";exports.id=3294,exports.ids=[3294],exports.modules={73294:(e,t,r)=>{r.d(t,{fromHttp:()=>g});var o=r(30675),n=r(18427),s=r(68696),a=r(20629),i=r.n(a);let d=(e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;let t=e.hostname.split("."),r=e=>{let t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new s.mV(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:t})}};var l=r(41250),c=r(49929),h=r(82990);async function u(e,t){let r=(0,h.Ou)(e.body),o=await r.transformToString();if(200===e.statusCode){let e=JSON.parse(o);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new s.mV("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:(0,c.uj)(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(o)}catch(e){}throw Object.assign(new s.mV(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new s.mV(`Server responded with status: ${e.statusCode}`,{logger:t})}let p=(e,t,r)=>async()=>{for(let o=0;o<t;++o)try{return await e()}catch(e){await new Promise(e=>setTimeout(e,r))}return await e()},g=(e={})=>{let t;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let r=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,a=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,c=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,h=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,g=e.logger?.constructor?.name!=="NoOpLogger"&&e.logger?e.logger.warn:console.warn;if(r&&a&&(g("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),g("awsContainerCredentialsFullUri will take precedence.")),c&&h&&(g("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),g("awsContainerAuthorizationToken will take precedence.")),a)t=a;else if(r)t=`http://169.254.170.2${r}`;else throw new s.mV(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});let w=new URL(t);d(w,e.logger);let f=new n.NA({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return p(async()=>{let t=function(e){return new l.aW({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce((e,[t,r])=>(e[t]=r,e),{}),fragment:e.hash})}(w);c?t.headers.Authorization=c:h&&(t.headers.Authorization=(await i().readFile(h)).toString());try{let e=await f.handle(t);return u(e.response).then(e=>(0,o.P)(e,"CREDENTIALS_HTTP","z"))}catch(t){throw new s.mV(String(t),{logger:e.logger})}},e.maxRetries??3,e.timeout??1e3)}}};
//# sourceMappingURL=3294.js.map